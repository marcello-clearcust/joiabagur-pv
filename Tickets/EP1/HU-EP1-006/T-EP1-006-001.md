# T-EP1-006-001: Create product catalog API endpoint

## Title
Create product catalog API endpoint with role-based filtering

## Description

Implement GET /api/products endpoint with pagination and role-based filtering. **Administrators see all products from the global catalog. Operators see only products that have Inventory records at their assigned points of sale.**

**Purpose:**
- Provide paginated product listing filtered by role
- Include primary photo information and quantity indicators
- Support catalog browsing for all authenticated users with proper access control

**Details:**
- GET /api/products with pagination parameters (page, pageSize, sortBy)
- **Implement inventory-based filtering for operators** (JOIN with Inventory and UserPointOfSale tables)
- Include primary photos and aggregated quantity in response
- Default page size 50, configurable
- Sort by name or creation date
- Return ProductDto with essential information (Id, SKU, Name, Price, PrimaryPhotoUrl, AvailableQuantity)
- Extract user context from JWT claims (user ID, role)
- Add database index on (PointOfSaleId, ProductId) for query performance

## Acceptance Criteria

- [ ] Paginated product listing working with role-based filtering
- [ ] Administrators see all products from global catalog
- [ ] Operators see only products with Inventory records at assigned POS
- [ ] Operators with multiple POS assignments see aggregated products without duplicates
- [ ] Primary photo and quantity included in responses
- [ ] Proper pagination metadata (totalCount, totalPages, currentPage)
- [ ] Authentication required (both admin and operator roles)
- [ ] Performance optimized with database index on Inventory table
- [ ] Products with quantity = 0 included for operators (if Inventory record exists)

## Priority
High (catalog browsing functionality)

## Estimation
2 SP

## Assignment
Backend - API

## Tags
HU-EP1-006, api, pagination, catalog, product-module

## Links
- User Story: `Documentos/Historias/HU-EP1-006.md`
- Depends on: T-EP1-001-007
