# T-EP1-001-006: Implement Excel import service for products

## Title
Implement Excel import service for products

## Description

Implement ExcelImportService that processes Excel files (.xlsx/.xls) and performs bulk product creation/update operations with proper validation and transaction handling.

**Purpose:**
- Process Excel files with product data
- Validate data before import (SKU uniqueness, required fields, price validation)
- Perform UPSERT operations (create new or update existing products)
- Handle collection creation automatically if needed
- Provide detailed error reporting for failed imports

**Details:**
- Use ClosedXML library for Excel processing (already in project dependencies)
- Validate Excel format and required columns (SKU, Name, Price)
- Check for duplicate SKUs within file
- Use database transactions for atomicity (all-or-nothing)
- Create collections automatically if referenced but don't exist
- Return detailed import results (success count, errors, warnings)
- Handle large files efficiently with streaming if needed

**References:**
- User Story requirements: `Documentos/Historias/HU-EP1-001.md` (all scenarios)
- Excel format specification: SKU, Name, Description, Price, Collection columns
- Testing guide: `Documentos/Testing/Backend/09-archivos-uploads.md`

## Acceptance Criteria

- [ ] ExcelImportService processes .xlsx and .xls files correctly
- [ ] Validates required columns and data formats
- [ ] Detects duplicate SKUs within the import file
- [ ] Performs UPSERT operations (create/update based on SKU existence)
- [ ] Creates collections automatically when referenced
- [ ] Uses database transactions for atomicity
- [ ] Returns detailed results with success/error counts
- [ ] Handles large files efficiently
- [ ] Comprehensive error messages for validation failures

## Priority
High (core functionality for bulk product import)

## Estimation
8 SP

## Assignment
Backend - Application

## Tags
HU-EP1-001, application, excel-import, closedxml, transaction, validation, product-module

## Links
- User Story: `Documentos/Historias/HU-EP1-001.md`
- Testing Guide: `Documentos/Testing/Backend/09-archivos-uploads.md`
- Depends on: T-EP1-001-001, T-EP1-001-004
