# T-EP1-001-009: Unit tests for Excel import service

## Title
Unit tests for Excel import service

## Description

Create comprehensive unit tests for ExcelImportService covering all import scenarios, validations, and edge cases using xUnit, Moq, and FluentAssertions.

**Purpose:**
- Ensure Excel import logic works correctly in isolation
- Test all validation scenarios and business rules
- Provide confidence in import functionality reliability

**Details:**
- Test data validation (required fields, price > 0, SKU format)
- Test duplicate SKU detection within file
- Test UPSERT logic (create vs update existing products)
- Test automatic collection creation
- Test transaction handling and rollback scenarios
- Mock repository dependencies for isolated testing
- Use Bogus for generating test data
- Follow AAA pattern (Arrange, Act, Assert)

**References:**
- Testing guide: `Documentos/Testing/Backend/02-tests-unitarios.md`
- Excel upload guide: `Documentos/Testing/Backend/09-archivos-uploads.md`
- User Story scenarios: All acceptance criteria in HU-EP1-001
- Stack: xUnit, Moq, FluentAssertions, Bogus

## Acceptance Criteria

- [ ] Tests cover all validation scenarios from user story
- [ ] UPSERT logic tested (create new + update existing)
- [ ] Duplicate SKU detection tested
- [ ] Automatic collection creation tested
- [ ] Transaction handling tested (success and rollback)
- [ ] Edge cases covered (empty file, invalid format, large files)
- [ ] Mocked dependencies (repositories) for isolation
- [ ] Test naming follows `MÃ©todo_Escenario_ResultadoEsperado` convention
- [ ] Code coverage meets minimum threshold (70%)

## Priority
Medium (testing enables confidence in production deployment)

## Estimation
5 SP

## Assignment
Backend - Tests

## Tags
HU-EP1-001, test, unit-test, xunit, moq, fluentassertions, bogus, excel, product-module

## Links
- User Story: `Documentos/Historias/HU-EP1-001.md`
- Testing Guides: `Documentos/Testing/Backend/02-tests-unitarios.md`, `Documentos/Testing/Backend/09-archivos-uploads.md`
- Depends on: T-EP1-001-006
