# HU-EP5-001: Registrar devolución de producto vendido

## Formato estándar

Como **administrador**, quiero **registrar devoluciones de productos vendidos** para **incrementar el stock y mantener trazabilidad con la venta original**.

---

## Descripción

Permite registrar una devolución asociada a una venta original. El sistema incrementa automáticamente el stock en el punto de venta correspondiente y genera un movimiento de inventario tipo "Return".

---

## Criterios de Aceptación

### Escenario 1: Devolución exitosa
**Dado que** existe una venta registrada  
**Cuando** registro una devolución asociada a esa venta  
**Entonces** se crea registro en `Return`  
**Y** se incrementa el stock del producto en el punto de venta  
**Y** se crea movimiento en `InventoryMovement` tipo "Return"  
**Y** se puede registrar motivo opcional

### Escenario 2: Validar venta existente
**Dado que** intento registrar devolución de una venta que no existe  
**Cuando** ingreso un ID de venta inválido  
**Entonces** el sistema muestra error: "Venta no encontrada"  
**Y** no se registra la devolución

### Escenario 3: Devolución con motivo
**Dado que** registro una devolución  
**Cuando** ingreso un motivo (ej: "Producto defectuoso")  
**Entonces** el motivo se guarda en `Return.Reason`  
**Y** aparece en el historial de devoluciones

---

## Tareas

1. Backend: Endpoint `POST /api/returns` con validación de venta existente
2. Backend: Transacción para devolución + movimiento de inventario
3. Frontend: Formulario de devolución con búsqueda de venta original

---

## Estimaciones y atributos de priorización

- **Puntos de historia:** _Pendiente_
- **Dependencias:** HU-EP3-001, HU-EP3-002, HU-EP2-002

