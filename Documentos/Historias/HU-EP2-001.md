# HU-EP2-001: Importar stock desde Excel

## Formato estándar

Como **administrador**, quiero **importar stock desde un archivo Excel** para **actualizar las cantidades de productos en un punto de venta de forma masiva**.

---

## Descripción

Permite importar stock desde Excel (.xlsx o .xls) con columnas SKU y Quantity. El punto de venta se selecciona antes de subir el archivo. Si el producto ya tiene stock, se suma; si no, se crea el registro en `Inventory` (asignación implícita del producto al POS).

**Formato Excel:** SKU (obligatorio, debe existir en catálogo global), Quantity (obligatorio, >= 0)

**Nota importante:** Esta funcionalidad puede realizar **asignación implícita** de productos al punto de venta. Si prefieres asignar productos con cantidad inicial 0 sin importar cantidades, usa HU-EP2-006 (Asignar productos a POS).

---

## Criterios de Aceptación

### Escenario 1: Importar stock para productos existentes
**Dado que** un producto tiene stock 5 en un punto de venta  
**Cuando** importo Excel con Quantity 10 para ese producto  
**Entonces** el stock se actualiza a 15 (5 + 10)  
**Y** se crea movimiento en `InventoryMovement` tipo "Import"

### Escenario 2: Crear inventario para productos no asignados (asignación implícita)
**Dado que** un producto existe en el catálogo global  
**Y** NO tiene registro en `Inventory` para el punto de venta seleccionado  
**Cuando** importo Excel con Quantity 5 para ese producto  
**Entonces** se crea registro en `Inventory` con Quantity 5 y IsActive = true (asignación implícita)  
**Y** se crea movimiento en `InventoryMovement` tipo "Import"  
**Y** el producto se vuelve visible para operadores asignados al punto de venta  
**Y** se muestra mensaje: "Producto asignado al punto de venta e inventario actualizado"

### Escenario 3: SKU no encontrado en catálogo global
**Dado que** importo un Excel con SKU que no existe en el catálogo global de productos  
**Cuando** valido el archivo  
**Entonces** el sistema muestra error: "SKU no encontrado: [SKU]"  
**Y** no importa ese registro  
**Y** sugiere verificar que el producto fue importado previamente en EP1

### Escenario 4: Relación con asignación manual
**Dado que** quiero asignar productos al POS sin importar cantidades  
**Cuando** uso la funcionalidad de asignación manual (HU-EP2-006)  
**Entonces** los productos se asignan con Quantity = 0  
**Y** quedan disponibles para los operadores del POS  
**Y** posteriormente puedo importar cantidades mediante este flujo de importación Excel

---

## Tareas

1. Backend: Endpoint `POST /api/inventory/import` con selección de punto de venta
2. Backend: Servicio de importación con suma de cantidades y creación de movimientos
3. Frontend: Selección de punto de venta + carga de archivo

---

## Estimaciones y atributos de priorización

- **Puntos de historia:** _Pendiente_
- **Dependencias:** HU-EP1-002, HU-EP8-001

