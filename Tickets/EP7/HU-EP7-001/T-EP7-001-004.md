# T-EP7-001-004: Implement authentication API controller

## Purpose

Create the REST API endpoint for user authentication that exposes the login functionality to frontend clients. This includes request/response DTOs, input validation, error handling, and proper HTTP status codes.

## Details

### AuthController Implementation
- Create AuthController with POST /api/auth/login endpoint
- Implement LoginRequest and LoginResponse DTOs
- Add input validation using DataAnnotations or FluentValidation
- Handle authentication results and return appropriate HTTP responses

### Request/Response Models
- LoginRequest: Username and Password (required, validated)
- LoginResponse: JWT token, user info (id, username, role), expiration time
- Error responses: Generic error message for security

### API Security
- Implement rate limiting middleware on the endpoint
- Add CORS configuration for frontend access
- Configure proper HTTP security headers
- Implement request logging for security auditing

### Error Handling
- Return 400 Bad Request for validation errors
- Return 401 Unauthorized for authentication failures
- Return 429 Too Many Requests for rate limiting
- Return 500 Internal Server Error for unexpected errors
- Ensure error messages don't leak sensitive information

### Integration
- Inject IAuthenticationService into controller
- Map domain results to API responses
- Handle service exceptions appropriately

## Acceptance Criteria

- [ ] AuthController is created with POST /api/auth/login endpoint
- [ ] LoginRequest and LoginResponse DTOs are implemented
- [ ] Input validation is implemented and tested
- [ ] Authentication results are properly mapped to HTTP responses
- [ ] Rate limiting is configured at controller level
- [ ] Error handling returns appropriate HTTP status codes
- [ ] API follows REST conventions and is documented
- [ ] Endpoint can be called from Postman/Swagger for testing

## Priority
High

## Estimation
3 SP

## Dependencies
- T-EP7-001-003 (authentication application service)

## Tags
EP7, HU-EP7-001, api, controller, rest, validation, cors

## Links
- User Story: `Documentos/Historias/HU-EP7-001.md`
- API Standards: `Documentos/arquitectura.md` (API layer section)
- Testing: `Documentos/Testing/Backend/03-testcontainers.md` (for integration testing)
- Validation: `Documentos/Testing/Backend/08-validaciones.md` (for validation testing)

